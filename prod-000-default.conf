<VirtualHost *:80>

	ServerAdmin donsmoore@gmail.com

    ServerName donsmoore.com
    ServerAlias www.donsmoore.com
    DocumentRoot /var/www/html/donsmoore.com/

    Alias /timeclock/v3/ /var/www/html/donsmoore.com/timeclock/v3/public/
    <Directory /var/www/html/donsmoore.com/timeclock/v3/public/>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    # Fractals v2 static frontend
    Alias /fractals/v2/ /var/www/html/donsmoore.com/fractals/v2/frontend/
    <Directory /var/www/html/donsmoore.com/fractals/v2/frontend/>
        Options -Indexes +FollowSymLinks
        AllowOverride None
        Require all granted
        DirectoryIndex index.html
    </Directory>

    # Fractals v3 static frontend
    Alias /fractals/v3/ /var/www/html/donsmoore.com/fractals/v3/frontend/static/
    <Directory /var/www/html/donsmoore.com/fractals/v3/frontend/static/>
        Options -Indexes +FollowSymLinks
        AllowOverride None
        Require all granted
        DirectoryIndex index.html
    </Directory>

    # Mazes v1 static frontend
    Alias /mazes/v1/ /var/www/html/donsmoore.com/mazes/v1/
    <Directory /var/www/html/donsmoore.com/mazes/v1/>
        Options -Indexes +FollowSymLinks
        AllowOverride None
        Require all granted
        DirectoryIndex index.html
    </Directory>

    # Fractals v1 reverse proxy
	ProxyPreserveHost On
	ProxyPass        /fractals/v1/  http://127.0.0.1:8080/
	ProxyPassReverse /fractals/v1/  http://127.0.0.1:8080/

	<Location /fractals/v1>
		Require all granted
	</Location>

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined

    RewriteEngine on
    RewriteCond %{SERVER_NAME} =donsmoore.com [OR]
    RewriteCond %{SERVER_NAME} =www.donsmoore.com
    RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
s
</VirtualHost>
