<VirtualHost *:443>

	ServerAdmin donsmoore@gmail.com

#    DocumentRoot /var/www/html/donsmoore.com/
    DocumentRoot /var/www/html

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined

	# SSL Configuration (Let's Encrypt example)
	SSLEngine on
	SSLCertificateFile /etc/letsencrypt/live/donsmoore.com/fullchain.pem
	SSLCertificateKeyFile /etc/letsencrypt/live/donsmoore.com/privkey.pem
	SSLCertificateChainFile /etc/letsencrypt/live/donsmoore.com/chain.pem
	IncludeOptional /etc/letsencrypt/options-ssl-apache.conf

    Alias /timeclock/v3 /var/www/html/timeclock/v3/public/
    <Directory /var/www/html/timeclock/v3/public/>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    # Fractals v2 static frontend
    Alias /fractals/v2/ /var/www/html/fractals/v2/frontend/
    <Directory /var/www/html/fractals/v2/frontend/>
        Options -Indexes +FollowSymLinks
        AllowOverride None
        Require all granted
        DirectoryIndex index.html
    </Directory>

    # Fractals v3 static frontend
    Alias /fractals/v3/ /var/www/html/fractals/v3/frontend/static/
    <Directory /var/www/html/fractals/v3/frontend/static/>
        Options -Indexes +FollowSymLinks
        AllowOverride None
        Require all granted
        DirectoryIndex index.html
    </Directory>

    # Mazes v1 static frontend
    Alias /mazes/v1/ /var/www/html/mazes/v1/
    <Directory /var/www/html/mazes/v1/>
        Options -Indexes +FollowSymLinks
        AllowOverride None
        Require all granted
        DirectoryIndex index.html
    </Directory>

    # Fractals v1 reverse proxy
    # no need to setup https on reverse proxy
	ProxyPreserveHost On
	ProxyPass        /fractals/v1/  http://127.0.0.1:8080/
	ProxyPassReverse /fractals/v1/  http://127.0.0.1:8080/

	<Location /fractals/v1>
		Require all granted
	</Location>

	<FilesMatch "\.(?:cgi|shtml|phtml|php)$">
		SSLOptions +StdEnvVars
	</FilesMatch>

	<Directory /usr/lib/cgi-bin>
		SSLOptions +StdEnvVars
	</Directory>

</VirtualHost>
